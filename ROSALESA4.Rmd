---
title: "TRABAJO FINAL"
author: "Astrid Rosales Aedo (20196941)"
date: '2022-06-23'
output: html_document
---
# AUTOCRATIZACIÓN
#INTRODUCIÓN:
¿La autocratización cambia la naturaleza? La autocratización es el proceso inverso a la democratización. Es un proceso que limita o cancela el ejercicio de derechos y libertades, reduce o suprime el pluralismo y la oposición políticos, y favorece que el poder del gobierno se ejerza de forma discrecional, sin controles ni rendición de cuentas pública.

El Informe sobre la Democracia 2022 ofrece varios indicios de que los procesos de autocratización están pasando de los cambios graduales a una evolución más contundente. Los líderes parecen estar tomando medidas más audaces ahora que en el pasado. 

Tres áreas señalan esta naturaleza cambiante de la autocratización. En primer lugar, cinco golpes militares y un autogolpe en 2021 muestran que la autocratización ya no procede necesariamente a un ritmo lento y gradual. Estos golpes también ilustran que la autocratización no se limita a las democracias. La consolidación del poder en manos de unos pocos también se está produciendo en los países autocráticos. 

En segundo lugar, la polarización alcanzó niveles mundiales sin precedentes en 2021. Los líderes de 40 países contribuyeron a aumentar considerablemente la polarización tóxica durante la última década. Por el contrario, la polarización disminuyó sólo en 6 países. En los niveles actuales, la polarización y la autocratización forman un círculo vicioso que se refuerza mutuamente.

La polarización se vuelve tóxica cuando alcanza niveles extremos. Los bandos de "nosotros contra ellos" empiezan a cuestionar la legitimidad moral de los demás y comienzan a tratar a la oposición como una amenaza existencial para un modo de vida o una nación. Una vez que las élites políticas y sus seguidores dejan de creer que los oponentes políticos son legítimos y merecen el mismo respeto, las normas y reglas democráticas pueden dejarse de lado para "salvar la nación". Se trata de una evolución peligrosa.

En tercer lugar, y relacionado con lo anterior, los gobiernos utilizan cada vez más la desinformación como herramienta para manipular la opinión pública y su reputación internacional. La manipulación gubernamental de las estadísticas y el aumento de la desinformación en los medios digitales también muestran cómo los líderes políticos se están volviendo más audaces a la hora de fomentar la autocratización.

#OBJETIVO:
En este sentido, se evaluará respecto a los medios de comunicación en el presente informe tres variables referentes a la censura gubernamental para ver si afectan al  índice de democracia liberal, de  esta manera para corroborar si eso significa que los líderes políticos se están volviendo más audaces en la promoción del autoritarismo.

El principio liberal de la democracia hace hincapié en la importancia de la protección de los derechos individuales y de los menores frentes a la tiranía del Estado y a la tiranía de la mayoría. El modelo liberal adopta una visión "negativa" del poder político, ya que juzga la calidad de la democracia por los límites impuestos al gobierno. Esto se consigue mediante las libertades civiles protegidas por la Constitución, un fuerte estado de derecho, un poder judicial independiente y controles y equilibrios eficaces que, en conjunto, limitan el ejercicio del poder ejecutivo. Para que sea una medida de la democracia liberal, el índice también tiene en cuenta el nivel de democracia electoral.

Los medios de comunicación, en esta sección se distinguen dos tipos de medios de comunicación: (1) los impresos (periódicos y revistas) y los audiovisuales (radio y televisión), y (2) los medios de comunicación en línea. Así, "los medios de comunicación impresos y audiovisuales" pueden proporcionar una amplia gama de perspectivas en un país, incluso cuando las publicaciones o programas individuales adoptan una perspectiva consistentemente estrecha. Los tres variables a utilizar son las siguientes:

1. Censura gubernamental  (v2mecenefm) ¿Intenta el gobierno censurar directa o indirectamente los medios de comunicación impresos o audiovisuales? Las formas indirectas de censura pueden incluir la adjudicación de frecuencias de emisión por motivos políticos, la retirada de apoyo financiero, la inﬂuencia sobre las instalaciones de impresión y las redes de distribución, la distribución selectiva de publicidad, los requisitos onerosos de registro, los aranceles prohibitivos y el soborno. 

2. La censura en Internet (v2meceneﬁ) ¿Intenta el gobierno censurar la información (textual, sonora o visual) en Internet? Los intentos de censura incluyen el ﬁltrado de Internet (bloqueo del acceso a determinados sitios web o navegadores), los ataques de denegación de servicio y los cierres parciales o totales de Internet. 

3. Acoso a periodistas (v2meharjrn) ¿Los periodistas individuales son acosados - es decir, amenazados de difamación, arrestados, encarcelados, golpeados o asesinados - por actores gubernamentales o no gubernamentales poderosos mientras realizan actividades periodísticas legítimas?

#METODOLOGÍA:
La metodología a utilizar para corroborar será regresión lineal múltiple o gaussiana, análisis factorial exploratorio, análisis factorial confirmatorio, clusterización o análisis de conglomerados.

#ANÁLISIS:
Como se hizo mención en el objetivo central de este informe la variable dependiente será el  Índice de democracia liberal (v2x_libdem) y las variables independientes: censura gubernamental a medios de comunicación (v2mecenefm_ord), censura gubernamental en internet (v2mecenefi_ord) y  hostigamiento hacia periodistas (v2meharjrn_ord).

#La regresión lineal múltiple o gaussiana:
Al probar esta hipótesis vemos, que la primera variable con mayor efecto es hostigamiento hacia periodistas (v2meharjrn),  tiene un efecto significativo al 0.5 (indicado por el asterisco); segundo, que ese efecto es directo, pues el coeficiente calculado es positivo; y tercero que la magnitud de ese efecto es 0.356 lo que indica cuanto varia el índice de la democracia liberal en promedio cuando hostigamiento hacia periodistas se incrementa en una unidad. (Anexo/GRÁFICO 1)

-----Los periodistas individuales son acosados, amenazados de difamación, arrestados, encarcelados, golpeados o asesinados por actores gubernamentales o no gubernamentales poderosos mientras realizan actividades periodísticas legítimas afecta al índice de democracia liberal. 

La segunda variable con mayor efecto es Censura gubernamental (v2mecenefm_ord), tiene un efecto significativo al 0.5 (indicado por el asterisco); segundo, que ese efecto es directo, pues el coeficiente calculado es positivo; y tercero que la magnitud de ese efecto es 0.171 lo que indica cuanto varia el índice de la democracia liberal en promedio cuando censura gubernamental se incrementa en una unidad. (Anexo/GRÁFICO 1)

------ Intenta el gobierno censurar la información (textual, sonora o visual) en Internet afecta el índice de democracia liberal.

#SUPUESTOS:
LINEALIDAD:   La linealidad tiende a la horizontalidad, lo que señala que existe relación entre los tres factores y el índice de democracia. (Anexo/GRÁFICO 2)

HOMOCEDASTICIDAD: El modelo no muestra homocedasticidad, se asume que el error del modelo de regresión no afecta la varianza o dispersión de la estimación. El p.value< 0.5. (Anexo/GRÁFICO 3)

NORMALIDAD DE RESIDUOS: No hay normalidad de residuos, el p.value es menor a 0.5, puntos cerca de la diagonal. (Anexo/GRÁFICO 4)

NO HAY MULTICOLINEALIDAD: Los predictores no tienen una correlación alta, lo cual demuestra que no hay multicolinealidad, lo cual es favorable porque  los estimadores obtenidos y la precisión de éstos no se ven seriamente afectados. (Anexo/GRÁFICO 5)

VALORES INFLUYENTES: Existen valores influyentes perdidos, que se encuentra en el punto 9432. (Anexo/GRÁFICO 6)

#ANÁLISIS FACTORIAL EXPLORATORIO:
Para este análisis utilizare tres variables referentes a  Poder Judicial y exclusión social.

1. Independencia de la Corte Suprema (v2juhcind_ord) Cuando el alto tribunal del sistema judicial se pronuncia en casos que son importantes para el gobierno, ¿con qué frecuencia diría usted que toma decisiones que simplemente reflejan los deseos del gobierno, sin tener en cuenta su sincera visión de los antecedentes legales? 

2. Independencia de las otras cortes (v2juncind_ord) Cuando los jueces que no están en el alto tribunal fallan en casos que son importantes para el gobierno, ¿con qué frecuencia diría usted que sus decisiones reflejan simplemente los deseos del gobierno, independientemente de su visión sincera del expediente legal?

3. Acceso a oportunidades de negocios con el Estado a partir de posición socioeconómica (v2peasbecon_ord) ¿Las oportunidades de negocio del Estado están disponibles por igual para las personas cualificadas, independientemente de su posición socioeconómica? Las oportunidades de negocio del Estado se refieren a la capacidad de competir o recibir un contrato público, de asociarse con el gobierno en asociaciones público-privadas, etc. de contratación pública, de asociarse con el gobierno en asociaciones público-privadas, etc. La posición socioeconómica define a grupos basados en atributos de riqueza, ocupación u otras circunstancias económicas, como la posesión de propiedades.

#Explorar las correlaciones entre las variables:

Independencia de la Corte Suprema (v2juhcind_ord), Independencia de las otras cortes (v2juncind_ord), Acceso a oportunidades de negocios con el Estado a partir de posición socioeconómica (v2peasbecon_ord) con mis variables de censura gubernamental poseen una correlación alta porque el valor es mayor que 0 indica que existe una correlación positiva. En este caso las variables estarían asociadas en sentido directo. Cuanto más cerca de +1, más alta es su asociación. Un valor exacto de +1 indicaría una relación lineal positiva perfecta. (Anexo/GRÁFICO 7)

Las variables si se pueden factorizar porque MSA es mayor a 0.6. Se descarta matriz de identidad y matriz singular. (Anexo/GRÁFICO 8)

Las variables se agrupan en un factor, y el modelo recupera 0.639. (Anexo/GRÁFICO 8)

Las variables que aportaron más al modelo son Independencia de la Corte Suprema y Censura Gubernamental a Medios de Comunicación. (Anexo/GRÁFICO 9)

----- Significa que Independencia de la Corte Suprema y censura gubernamental a los medios de comunicación son factores que influyen demasiado afectando el índice de democracia liberal.

#ANÁLISIS FACTORIAL CONFIRMATORIO:
Todas las variables tienen buena relación con el factor creado. El p.value< 0.5 indica que la variable observable tiene buena relación con sus latente. (Anexo/GRÁFICO 10)

La asignación de las variables no fue buena porque el p.value es menor a 0.5,  el índice Tucker Lewi es menor a 0.9, y la raíz del error cuadrático medio de aproximación es mayor a 0.05. (Anexo/GRÁFICO 11)

#CLUSTERIZACIÓN O ANÁLISIS DE CONGLOMERADOS
Realizamos las tres clusterizaciones (PAM, AGNES, DIANA) para obtener el número recomendado de clusters. El modelo que mejor explica es PAM porque los residuos son menores en comparación con los otros. (Anexo/GRÁFICO 12)

En el gráfico de países se visualiza  que Ecuador y Filipinas en cuanto refiere a censura  gubernamental. En cambio, Papúa Nueva Guinea es cercana a Liberia con respecto a censura a internet.  Existe una gran diferencia con respect a Republica Dominicana y Corea del Sur con respecto al acoso hacia periodistas, en el primer este fenomeno es mayor. Con respecto a Bielorrusia y la Republica Democr´tica del Congo, tambien hay una amplia diferencia en cuanto refiere a la independencia de la Corte Suprema, en el Segundo país la independencia es menor. (Anexo/GRÁFICO 13)

#CONLSUIONES:
En el presente informe mediante el consiguiente análisis se ha corroborado que tanto las variables de censura gubernamental, Poder Judicial y exclusión social están fuertemente relacionadas, afectando de esta manera al indice de democracia liberal de los paises,  claramente en unas en mayor fuerza que en otras. En este sentido, se afirma que la autocratización es un situación ya existente y que irá aumentando. 

```{r}
library(rio)
library(DescTools)
library(ggplot2)
library(moments)
library(Rmisc)
library(e1071)
library(psych)
library(dplyr)
library(gplots)
library(vcd)
library(PMCMRplus)
library(nortest)
library(car)
library(stargazer)
library(lm.beta)
library(gtools)
library(jtools)
library(ggstance)
library(broom.mixed)
library(fastDummies)
library(writexl)
library(lmtest)
library(polycor)
library(ggcorrplot)
library(matrixcalc)
library(GPArotation)
library(lavaan)
library(BBmisc)
library(cluster)
library(factoextra)
library(qpcR)
```
#ANEXOS

```{r}
vdem = import("https://github.com/astrid1212/Entregable4/blob/main/V-Dem-CY-Core-v12.rds?raw=true")
```

#Variable dependiente - Índice de Democracia Liberal (v2x_libdem)
```{r}
summary(vdem$v2x_libdem)
```
```{r}
str(vdem$v2x_libdem)
```
#Variables independientes - Astrid Rosales
#Censura Gubernamental
#Censura Gubernamental a Medios de Comunicación (v2mecenefm_ord)
```{r}
str(vdem$ v2mecenefm_ord)
summary(vdem$v2mecenefm_ord)
```
#Censura Gubernamental en Internet (v2mecenefi_ord)
```{r}
str(vdem$v2mecenefi_ord)
summary(vdem$v2mecenefi_ord)
```
#Hostigamiento hacia periodistas (v2meharjrn_ord)
```{r}
str(vdem$v2meharjrn_ord)
summary(vdem$v2meharjrn_ord)
```
#Armar la base de apoyo
```{r}
vdem_astrid = subset(vdem, select = c(country_name, year, v2x_libdem, v2mecenefm_ord, v2mecenefi_ord, v2meharjrn_ord))
```

```{r}
vdem_astrid = vdem_astrid[vdem_astrid$year==2021,]
```

```{r}
vdem_astrid[, c(4:6)] = lapply(vdem_astrid[, c(4:6)], ordered)
```

```{r}
str(vdem_astrid$v2meharjrn_ord)
```
<<GRÁFICO 1>>

#Hacer la regresión lineal múltiple o gaussiana 
```{r}
modeloa <- lm(v2x_libdem~v2mecenefm_ord+v2mecenefi_ord+v2meharjrn_ord, data=vdem_astrid)
summary(modeloa)
```
#Observar en stargazer
```{r}
stargazer(modeloa, type = "text")
```

#Comprobar supuestos de regresión lineal

<<GRÁFICO 2>>
#Linealidad
```{r}
plot(modeloa, 1)
```
<<GRÁFICO 3>>
#Homocedasticidad
```{r}
plot(modeloa, 3)
```
#No hay homocedasticidad (p-value < 0.05)
```{r}
bptest(modeloa)
```
<<GRÁFICO 4>>
#Normalidad residual
#No hay normalidad (p-value < 0.05)
```{r}
plot(modeloa, 2)
shapiro.test(modeloa$residuals)
```

<<GRÁFICO 5>>
#No multicolinealidad
```{r}
VIF(modeloa)
```
<<GRÁFICO 6>>
#Valores influyentes
```{r}
plot(modeloa, 5)
```

```{r}
checkmoda = as.data.frame(influence.measures(modeloa)$is.inf)
head(checkmoda)
```

#Variables independientes- Carlos Chavarri
#Poder Judicila y exclusión social
#Independencia de la Corte Suprema (v2juhcind_ord)
```{r}
str(vdem$v2juhcind_ord)
summary(vdem$v2juhcind_ord)
```
#Independencia de las otras cortes (v2juncind_ord)
```{r}
str(vdem$v2juncind_ord)
summary(vdem$v2juncind_ord)
```
#Acceso a oportunidades de negocios con el Estado a partir de posición socioeconómica (v2peasbecon_ord)
```{r}
str(vdem$v2peasbecon_ord)
summary(vdem$v2peasbecon_ord)
```
#Armar la base de apoyo
```{r}
factor_astrid= subset(vdem, select = c(country_name, year, v2x_libdem, v2mecenefm_ord, v2mecenefi_ord, v2meharjrn_ord , v2juhcind_ord, v2juncind_ord, v2peasbecon_ord))
```
```{r}
factor_astrid = factor_astrid[factor_astrid$year==2021, ]
```
```{r}
factor_astrid$country_name = NULL
factor_astrid$year = NULL
factor_astrid$v2x_libdem = NULL
```
#Análisis Factorial Exploratorio

<<GRÁFICO 7>>
#Explorar las correlaciones entre las variables
```{r}
corMatrix_a = polycor::hetcor(factor_astrid)$correlations
corMatrix_a
```
#Graficar la matriz de correlaciones
```{r}
ggcorrplot(corMatrix_a)
```
#Verificar validez del análisis factorial

<<GRÁFICO 8>>
#Verificar si variables se pueden factorizar
Overall MSA es mayor a 0.6, por lo que el análisis factorial es factible.
```{r}
psych::KMO(corMatrix_a)
```
#Descartar una posible matriz de identidad
Sale FALSE (p-value NO es mayor a 0.05), por lo que el análisis factorial es factible.
```{r}
cortest.bartlett(corMatrix_a, n = nrow(factor_astrid))$p.value>0.05
```
#Descartar una posible matriz singular
Sale FALSE, por lo que el análisis factorial es factible.
```{r}
is.singular.matrix(corMatrix_a)
```
#Determinar en cuántos factores se pueden agrupar las variables
```{r}
fa.parallel(factor_astrid, fm = "ML", fa = "fa")
```
#Observar las cargas factoriales y ver en qué factores se ubicaría cada variable
```{r}
resfa_a <- fa(factor_astrid, nfactors = 1, cor = "cor", rotate = "varimax", fm = "minres")
print(resfa_a$loadings, cutoff = 0.5)
```
#Graficar cómo se agrupan las variables
```{r}
fa.diagram(resfa_a)
```
#Evaluar los resultados obtenidos

<<GRÁFICO 9>>
#¿Qué variables aportaron más a los factores?
```{r}
sort(resfa_a$communality)
```
#Observar los posibles valores proyectados
# Para grabar en la base los puntajes de los factores
```{r}
factor_astrid$puntaje = resfa_a$scores
```
#Analisis factorial confirmatorio

#Construir modelo lineal
```{r}
modeloa <- ' factor_a  =~ v2mecenefm_ord+v2mecenefi_ord+v2meharjrn_ord+v2juhcind_ord+v2juncind_ord+v2peasbecon_ord'
```

#Crear un objeto para hacer las validaciones 

```{r}
cfa_fit <- cfa(modeloa, data= factor_astrid, 
           std.lv=TRUE,  
           missing="fiml")
```

#Preparar los test para las validaciones
```{r}
allParamCFA=parameterEstimates(cfa_fit,standardized = T)
allFitCFA=as.list(fitMeasures(cfa_fit))
```
<<GRÁFICO 10>>
#Ver si cada variable tiene buena relacion con su factor (p.value< 0.5 indica que la variable observable tiene buena relacion con sus latente)
```{r}
allParamCFA[allParamCFA$op=="=~",]
```

<<GRÁFICO 11>>
# Ver si la asignacion de variables ha sido relativamente buena, el p.value debe ser mayor a 0.05 para que se bueno
```{r}
allFitCFA[c("chisq", "df", "pvalue")]
```
#El Índice Tucker Lewi es mayor a 0.9? Es menor.
```{r}
allFitCFA$tli
```
#La Raíz del error cuadrático medio de aproximación es menor a 0.05? No, es mayor
```{r}
allFitCFA[c('rmsea.ci.lower','rmsea' ,'rmsea.ci.upper')]
```
#Hacer predicciones (scores) de las variables latentes
```{r}
scorescfa=normalize(lavPredict(cfa_fit),
                    method = "range", 
                    margin=2, # by column
                    range = c(0, 10))
```

```{r}
factor_astrid$prediccion = scorescfa
```
#Veamos ambos scores calculados
```{r}
ggplot(data=factor_astrid,aes(x=prediccion,y=puntaje)) + geom_point() + theme_minimal()
```

# Clusterización o Análisis de Conglomerados
#Armar una base de apoyo
```{r}
cluster_astrid = subset(vdem, select = c(country_name, year, v2x_libdem, v2mecenefm_ord, v2mecenefi_ord, v2meharjrn_ord, v2juhcind_ord, v2juncind_ord, v2peasbecon_ord))
```

```{r}
cluster_astrid = cluster_astrid[cluster_astrid$year==2021,]
```

```{r}
row.names(cluster_astrid) = cluster_astrid$country_name
```

```{r}
cluster_astrid$country_name = NULL
cluster_astrid$year = NULL
cluster_astrid$v2x_libdem = NULL
```

```{r}
cluster_astrid = cluster_astrid[complete.cases(cluster_astrid),]
```

# Calcular las distancias entre elementos que permita agruparlos en clusters
```{r}
g.dist = daisy(cluster_astrid[, c(1:6)], metric = "gower")
```

<<GRÁFICO 12>>
#Para obtener el número recomendado de clusters
#Clusterización no jerárquica (PAM)
```{r}
fviz_nbclust(cluster_astrid[, c(1:6)], pam, diss = g.dist, method = "gap_stat", k.max = 10, verbose = F)
```
#Clusterización por agrupación (AGNES)
```{r}
fviz_nbclust(cluster_astrid[, c(1:6)], hcut, diss = g.dist, method = "gap_stat", k.max = 10, verbose = F, hc_func = "agnes")
```
#Clusterización por división (DIANA)
```{r}
fviz_nbclust(cluster_astrid[, c(1:6)], hcut, diss = g.dist, method = "gap_stat", k.max = 10, verbose = F, hc_func = "diana")
```
#Hacer asignación de clusters en base a número de clusters recomendados
#Clusterización no jerárquica (PAM)
```{r}
res.pam = pam(g.dist, k = 4, cluster.only = F)
cluster_astrid$clustPT = res.pam$cluster
```
#Clusterización agrupativa (AGNES)
```{r}
res.agnes = hcut(g.dist, k = 8, hc_func = "agnes", hc_method = "ward.D")
cluster_astrid$clustAG = res.agnes$cluster
```
#Clusterización divisiva (DIANA)
```{r}
res.diana = hcut(g.dist, k = 4, hc_func = "diana")
cluster_astrid$clustDIV = res.diana$cluster
```
#Dar puntaje a la clusterización
#Clusterización no jerárquica (PAM)
```{r}
fviz_silhouette(res.pam)
```
#Clusterización agrupativa (AGNES)
```{r}
fviz_silhouette(res.agnes)
```
#Clusterización divisiva (DIANA)
```{r}
fviz_silhouette(res.diana)
```
#Encontrar los casos mal clusterizados según cada método
#Clusterización no jerárquica (PAM)
```{r}
silPAM = data.frame(res.pam$silinfo$widths)
silPAM$country = row.names(silPAM)
malPAM = silPAM[silPAM$sil_width<0,"country"]%>%sort() 
```
#Clusterización agrupativa (AGNES)
```{r}
silAGNES = data.frame(res.agnes$silinfo$widths)
silAGNES$country = row.names(silAGNES)
malAGNES = silAGNES[silAGNES$sil_width<0,"country"]%>%sort() 
```
#Clusterización divisiva (DIANA)
```{r}
silDIANA = data.frame(res.diana$silinfo$widths)
silDIANA$country = row.names(silDIANA)
malDIANA = silDIANA[silDIANA$sil_width<0,"country"]%>%sort() 
```
#Juntar elementos mal clusterizados en un solo data frame
```{r}
mal_Clus = as.data.frame(qpcR:::cbind.na(malPAM, malAGNES, malDIANA))
mal_Clus
```
<<GRÁFICO 13>>
#Graficar la mejor clusterización (PAM)
```{r}
proyeccion = cmdscale(g.dist, k=2,add = T) 
cluster_astrid$dim1 <- proyeccion$points[,1]
cluster_astrid$dim2 <- proyeccion$points[,2]
base = ggplot(cluster_astrid, aes(x=dim1, y=dim2,label=row.names(cluster_astrid))) 
base + geom_text(size = 2, aes(color = as.factor(clustPT))) + labs(title = "PAM") 
```











